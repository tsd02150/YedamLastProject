<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/layout2}">

<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
<style>
/* 주문상품 정보 */
.orderGoods_div {
	margin-top: 30px;
}

.goods_kind_div {
	font-size: 25px;
	line-height: 35px;
	font-weight: bold;
}

.goods_subject_table {
	font-size: 14px;
	line-height: 20px;
	width: 100%;
	text-align: center;
}

.goods_subject_table th {
	text-align: center;
	color: #333;
	border-bottom: 1px solid #e7e7e7;
	border-top: 2px solid #3084d9;
	background: #f4f9fd;
	padding: 2px 0;
}

.goods_table {
	font-size: 14px;
	line-height: 20px;
	border-bottom: 1px solid #e7e7e7;
}

.goods_table tr {
	height: 110px;
}

.goods_table_price_td {
	text-align: center;
}

/* 이미지 */
.image_wrap {
	width: 100%;
	height: 100%;
}

.image_wrap img {
	max-width: 85%;
	height: auto;
	display: block;
}
</style>
</head>
<body>
<div layout:fragment="mypage">
	<div id="mypageBody">
	<!-- 상품 정보 -->
		<div class="orderGoods_div">
			<!-- 상품 종류 -->
			<div class="goods_kind_div">
				주문상품 <span class="goods_kind_div_kind"></span>총 <span
					class="goods_kind_div_count" th:text="${#lists.size(orderList)}"></span>개
			</div>
			<div id="myorderDiv">
					<h4>주문 | 배송 내역</h4>
					<input type="date" id="startDate">
					<input type="date" id="endDate">
					<select id="orderSel">
			    <option value="">전체거래</option>
			    <option value="매도">매도</option>
			    <option value="매수">매수</option>
			    <option value="충전">충전</option>
			    <option value="포인트몰">포인트몰</option>
			</select>
			<!-- 상품 테이블 -->
			<table class="goods_subject_table">
				<colgroup>
					<col width="15%">
					<col width="35%">
					<col width="25%">
					<col width="25%">
				</colgroup>
				<tbody>
					<tr>
						<th>이미지</th>
						<th>상품 정보</th>
						<th>수량</th>
						<th>판매가</th>
					</tr>
				</tbody>
			</table>
			<table class="goods_table">
				<colgroup>
					<col width="20%">
					<col width="30%">
					<col width="25%">
					<col width="25%">
				</colgroup>
				<tbody>
					<tr th:each="item :${orderList}">
						<td>
							<div class="image_wrap">
								<img th:src="|/mall/images/main/${item.thumb}|">
							</div>
						</td>
						<td th:text="${item.nm}"></td>
						<td class="goods_table_price_td" th:text="${item.cnt}"><span>수량</span>
							<br></td>
						<td
							th:text="${#numbers.formatInteger((item.prc - (item.prc * item.dcRate / 100)) * item.cnt, 0, 'COMMA')}+' P'"></td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- 상품 정보 end -->
	</div>
	
	<script>
	const dt = "[[${#dates.format(session.loggedInMember.joinDt, 'yyyy/MM/dd')}]]";
	let dtFormat = "[[${#dates.format(session.loggedInMember.joinDt, 'yyyy-MM-dd')}]]";
	
	let orderSt = '';
	let shipSt = '';
	let targetPage = 1;
	let startPage=1;
	let endPage=20;
	let page =1;
	
	let today = new Date();   
	let year = today.getFullYear(); // 년도
	let month = today.getMonth() + 1 <10 ? '0'+(today.getMonth() + 1) : today.getMonth() + 1;  // 월
	let date = today.getDate() < 10 ? date = '0'+today.getDate() : today.getDate();  // 날짜
	let endDate = year + '/' + month + '/' + date; 
	let startDate = dt;

	$("#startDate").val(dtFormat);
	$("#endDate").val(`${year}-${month}-${date}`);

	shipList();
	function shipList(){
		$.ajax({
			url : "shipList",
			method : "POST",
			data : {
				"orderSt" : orderSt,
				"shipSt" : shipSt,
				"startDate" : startDate,
				"endDate" : endDate,
				"page" : page
			},
			success : function(data){
				data.forEace(el=>{
					console.log(el);
				})
			},
			error : function(err){
				console.log(err)
			}
		});
	}
	</script>
</div>
</body>

</html>