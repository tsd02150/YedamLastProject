<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/layout}">
<head>
	<meta charset="UTF-8">
	<style>
		.login {
			padding: 0;
		}

		.login-signup section-padding {
			padding-top: 0;
		}

		.py-20 {
			clear: both;
			height: 20px;
		}
		
		label{ display: inline-block; margin-right: 5px; }
	</style>
</head>

<body>
	<section class="login-signup section-padding" layout:fragment="content">
		<div class="container">
			<div class="row align-items-center justify-content-center">
				<div class="col-lg-7">
					<div class="findMyId">
						<div class="text-center">
							<h3>아이디 찾기</h3>
						</div>
						<div class="py-20"></div>
					</div>

					<form action="findid" class="login-form row" method="post">
						<!-- th:onsubmit="validateForm()" -->
						<div class="col-md-12">
							<div class="form-group">
								<label for="mname">이름</label>
								<input type="text" id="mname" class="form-control" name="nm" placeholder="이름을 입력하세요" required>
								<span id="nameCheck"></span>
							</div>
						</div>
						<div class="col-md-12">
							<div class="form-group">
								<label for="telInput">연락처</label><br><input type="text" class="form-control" oninput="autoHyphen(this)"
									maxlength="13" name="to" id="telInput" placeholder="전화번호를 입력하세요" style="width : 70%; display : inline;">
									<button type="button" id="codeBtn">인증번호 발송</button>
								<label for="codeCheckInput"></label>
								<input type="text" class="form-control" name="confirmcode" id="codeCheckInput" placeholder="인증번호를 입력하세요"style="width : 70%; display : inline;">
								<button type="button" id="codeCheckBtn">인증번호 확인</button>
							</div>
						</div>
						<div class="col-md-12">
								<button class="btn btn-primary" type="submit">아이디찾기</button>
						</div>
					</form>
				</div>
			</div>
		</div>
		
		<script>
		//연락처 저장 포맷 & 유효성검사
		 const autoHyphen = (target) => {
			    target.value = target.value.replace(/[^0-9]/g, '').replace(/^(\d{3})(\d{4})(\d{4})$/, `$1-$2-$3`);
			   	//console.log(target.value);
			};
			
			//이름 유효성 검사
			const nameInput = document.querySelector("#mname");
			const nameCheck = document.querySelector("#nameCheck");
			const telInput = document.querySelector("#telInput");

			nameInput.addEventListener("input", function() {
			    const name = nameInput.value;

			    // Regular expression to validate Korean name
			    const nameRegex = /^[가-힣]{2,5}$/;

			    if (nameRegex.test(name)) {
			        nameCheck.textContent = "";
			    } else {
			        nameCheck.textContent = "올바르게 입력하세요.";
			    }
			});
			
			//sms 인증번호 발송
			document.getElementById("codeBtn").addEventListener("click", function(){
				if(nameInput.value == ""){
					nameInput.focus();
					return;
				}
				if(telInput.value == ""){
					telInput.focus();
					return;
				}
				
				$.ajax({
					url : "sendSms",
					method : "POST",
					data : {
						to : telInput.val(),
						content : "[SMS] 인증번호 ["+createSmsKey()+"]를 입력해주세요" //
					},
					success : function(response){
					},
					error : function(err){
						console.log(err);
					}
				})
			})
			
			//sms 인증번호 확인.
			document.getElementById("codeCheckBtn").addEventListener("click", function(){
				console.log(this);
			}) //sms 인증번호 확인 끝.
			
			
			function createSmsKey(){
				return 123456;
			}
		</script>

	</section>
</body>

</html>